
<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MVP - Cadastro de Usuário</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 2rem; }
      .card { max-width: 720px; border: 1px solid #ddd; border-radius: 8px; padding: 1.25rem; }
      label { display:block; margin: .5rem 0 .25rem; }
      input, textarea { width: 100%; padding: .5rem; border: 1px solid #ccc; border-radius: 6px; }
      button { margin-top: 1rem; padding: .75rem 1rem; border: 0; border-radius: 6px; cursor: pointer; }
      .primary { background: #2563eb; color: white; }
      .muted { color: #555; }
      .row { display:flex; gap: 1rem; }
      .row > div { flex:1; }
      pre { background:#f8f8f8; padding: .75rem; border-radius: 6px; overflow:auto; }
    </style>
  </head>
  <body>
    <h1>Biblioteca Pública — MVP (Semana 2)</h1>
    <p class="muted">Fluxo implementado: <strong>Cadastro de Usuário → Upload de documentos → Persistência no Banco</strong></p>
    <div class="card">
      <form id="formCadastro">
        <label>Nome completo*</label>
        <input name="nome" required />
        <div class="row">
          <div>
            <label>E-mail*</label>
            <input type="email" name="email" required />
          </div>
          <div>
            <label>Telefone</label>
            <input name="telefone" />
          </div>
        </div>
        <label>Endereço</label>
        <textarea name="endereco"></textarea>
        <div class="row">
          <div>
            <label>Documento com foto (PNG/JPG/PDF)</label>
            <input type="file" name="documento" />
          </div>
          <div>
            <label>Comprovante de endereço (PNG/JPG/PDF)</label>
            <input type="file" name="comprovante" />
          </div>
        </div>
        <button class="primary" type="submit">Salvar cadastro</button>
      </form>
      <div id="resultado"></div>
    </div>

    <script>
      const API_BASE = "http://127.0.0.1:8000";
      const form = document.getElementById('formCadastro');
      const resultado = document.getElementById('resultado');

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const data = new FormData(form);
        try {
          const res = await fetch(`${API_BASE}/usuarios`, { method: 'POST', body: data });
          if (!res.ok) {
            const err = await res.json();
            throw new Error(err.detail || 'Erro ao cadastrar.');
          }
          const json = await res.json();
          resultado.innerHTML = '<h3>Usuário cadastrado!</h3><pre>'+JSON.stringify(json, null, 2)+'</pre>';
          form.reset();
        } catch (err) {
          resultado.innerHTML = '<p style="color:#b91c1c">Erro: '+err.message+'</p>';
        }
      });
    </script>
  </body>
</html>
